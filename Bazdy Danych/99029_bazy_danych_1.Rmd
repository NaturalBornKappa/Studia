---
title: "99029_bazy_danych_1"
author: "Jakub Bauer"
date: "4 semestr"
output: html_document
---

```{SQL setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{SQL,  include=FALSE}
DROP DATABASE IF EXISTS baza_danych;

CREATE DATABASE WcaleNieJakub;


USE WcaleNieJakub;

CREATE TABLE wojewodztwa 
(kod_w	char(3) not null,
 PRIMARY KEY (kod_w),
 wojewodztwo varchar(30) not null
);


INSERT INTO wojewodztwa (kod_w, wojewodztwo)
VALUES ('dol', 'dolnoœl¹skie'), ('kuj', 'kujawsko-pomorskie'), ('lub','lubelskie'), ('lue','lubuskie'), ('lod','³ódzkie'), ('mal','ma³opolskie'), ('maz','mazowieckie'), ('opo','opolskie'), ('pod','podkarpackie'), ('pol','podlaskie'), ('pom','pomorskie'), ('sla','œl¹skie'), ('swi','œwiêtokrzyskie'), ('war','warmiñsko-mazurskie'), ('wie','wielkopolskie'), ('zac','zachodniopomorskie');

CREATE TABLE miasta 
(id_miasta 	int not null AUTO_INCREMENT, primary key(id_miasta),
 kod_w char(3) not null,
	foreign key (kod_w) references wojewodztwa(kod_w),
	nazwa 		varchar(30) not null
);


INSERT INTO miasta (kod_w, nazwa) VALUES ('maz', 'Weso³a');

SET @id_wes = LAST_INSERT_ID();

INSERT INTO miasta (kod_w, nazwa) VALUES ('maz', 'Warszawa');

SET @id_wwa = LAST_INSERT_ID();

INSERT INTO miasta (kod_w, nazwa) VALUES ('pom', 'Gdañsk');

SET @id_gda = LAST_INSERT_ID();

INSERT INTO miasta (kod_w, nazwa) VALUES ('pom', 'Sopot');

SET @id_sop = LAST_INSERT_ID();



CREATE TABLE osoby 
(	id_osoby	int 		not null AUTO_INCREMENT,
	primary key (id_osoby),
	id_miasta	int 		not null,
	foreign key (id_miasta) references miasta(id_miasta),
	imie		varchar(20) 	not null,
	nazwisko	varchar(30) 	not null
);


CREATE TABLE firmy 
(	nazwa_skr	char(4) 	not null
,	primary key (nazwa_skr)
,	id_miasta	int 		not null
,	foreign key (id_miasta) references miasta(id_miasta)
,	nazwa		varchar(60) 	not null
,	kod_pocztowy	char(6)		not null
,	ulica		varchar(60)	not null
);



INSERT INTO osoby (imie, nazwisko, id_miasta) VALUES ('Maciej', 'Stodolski', @id_wes);

SET @id_ms =  LAST_INSERT_ID();


INSERT INTO osoby (imie, nazwisko, id_miasta) VALUES ('Jacek', 'Korytkowski', @id_wwa);

SET @id_jk =  LAST_INSERT_ID();


INSERT INTO osoby (imie, nazwisko, id_miasta) VALUES ('Mis', 'Nieznany', @id_gda);
INSERT INTO osoby (imie, nazwisko, id_miasta) VALUES ('Krol', 'Neptun', @id_sop);

set @id_kn =  LAST_INSERT_ID();


INSERT INTO osoby (imie, nazwisko, id_miasta) VALUES ('Juz', 'Niepracujacy', @id_wwa);

SET @id_jn =  LAST_INSERT_ID();


INSERT INTO firmy 
(	nazwa_skr
,	nazwa
,	id_miasta
,	kod_pocztowy
,	ulica
) VALUES 
(	'HP'
, 	'Hewlett Packard'
,	@id_wwa
,	'00-000'
,	'Szturmowa 2a'
);


INSERT INTO firmy 
(	nazwa_skr
,	nazwa
,	id_miasta
,	kod_pocztowy
,	ulica
) VALUES 
(	'UKSW'
,	'Uniwersytet Kardynala Stefana Wyszynskiego'
,	@id_wwa
,	'00-001'
,	'Dewajtis 5'
);


INSERT INTO firmy 
(	nazwa_skr
,	nazwa
,	id_miasta
,	kod_pocztowy
,	ulica
) VALUES 
(	'FLP'
,	'Fabryka Lodzi Podwodnych'
,	@id_wwa
,	'00-000'
,	'Na dnie 4'
);

CREATE TABLE etaty 
(	id_osoby 	int 		not null 
,	foreign key  (id_osoby)	references osoby(id_osoby)
,	id_firmy 	char(4) 	not null 
,	foreign key (id_firmy) references firmy(nazwa_skr)
,	stanowisko	varchar(60)	not null
,	pensja 		decimal(10,4) 		not null
,	od 		datetime 	not null
,	do 		datetime 	null
,	id_etatu 	int 		not null AUTO_INCREMENT 
,	primary key (id_etatu) 
);



INSERT INTO etaty 
(id_osoby
,	id_firmy
,	pensja
,	od
,	do
,	stanowisko
) VALUES 
(	@id_ms
,	'UKSW'
,	600
,	'1994-01-01'
,	'1998-01-01'
,	'Doktorant'
);


INSERT INTO etaty 
(id_osoby
,	id_firmy
,	pensja
,	od
,	do
,	stanowisko
) VALUES 
(	@id_ms
,	'UKSW'
,	1600
,	'1998-01-02'
,	'2000-01-01'
,	'Asystent'
);


INSERT INTO etaty 
(id_osoby
,	id_firmy
,	pensja
,	od
,	stanowisko
) VALUES 
(	@id_ms
,	'UKSW'
,	3200
,	'2000-01-02'
,	'Adiunkt'
);


INSERT INTO etaty 
(id_osoby
,	id_firmy
,	pensja
,	od
,	stanowisko
) VALUES 
(	@id_ms
,	'UKSW'
,	2200
,	'1999-01-01'
,	'Sprzatacz'
);


INSERT INTO etaty 
(id_osoby
,	id_firmy
,	pensja
,	od
,	stanowisko
) VALUES 
(	@id_ms
,	'HP'
,	20000
,	'2000-01-01'
,	'Konsultant'
);

INSERT INTO etaty 
(id_osoby
,	id_firmy
,	pensja
,	od
,	stanowisko
) VALUES 
(	@id_jk
,	'UKSW'
,	3200
,	'2001-11-10'
,	'Adiunkt'
);



INSERT INTO etaty 
(id_osoby
,	id_firmy
,	pensja
,	od
,	stanowisko
,	do
) VALUES 
(	@id_ms
,	'UKSW'
,	4200
,	'2004-09-22'
,	'Magazynier'
,	'2004-10-22'
);


INSERT INTO etaty 
(id_osoby
,	id_firmy
,	pensja
,	od
,	stanowisko
,	do
) VALUES 
(	@id_jn
,	'HP'
,	50000
,	'2000-01-01'
,	'Dyrektor'
,	'2002-10-21'
);


INSERT INTO etaty 
(id_osoby
,	id_firmy
,	pensja
,	od
,	stanowisko
,	do
) VALUES 
(	@id_ms
,	'FLP'
,	6200
,	'2004-09-22'
,	'Kierownik'
,	'2004-10-22'
);


INSERT INTO etaty 
(id_osoby
,	id_firmy
,	pensja
,	od
,	stanowisko
) VALUES 
(	@id_kn
,	'FLP'
,	65200
,	'2004-10-23'
,	'Prezes'
);

CREATE TABLE CECHY
(id_CECHY	int 		NOT NULL AUTO_INCREMENT
,	PRIMARY KEY (id_CECHY)
,	Opis_cechy	varchar(60)	NOT NULL
,	jednowybieralna	bit		NOT NULL	DEFAULT 0
);


CREATE TABLE WARTOSCI_CECH
(	id_wartosci	int		NOT NULL	AUTO_INCREMENT
,	PRIMARY KEY (id_wartosci)
,	id_CECHY	int 		NOT NULL
,	FOREIGN KEY (id_CECHY) REFERENCES CECHY(ID_CECHY)
,	Opis_wartosci	varchar(40)	NOT NULL
);


CREATE TABLE FIRMY_CECHY
(	id_wartosci	int		NOT NULL
,	FOREIGN KEY (id_wartosci) REFERENCES WARTOSCI_CECH(ID_WARTOSCI)
,	id_firmy	char(4)		NOT NULL
,	PRIMARY KEY (id_wartosci,id_firmy)
);


INSERT INTO CECHY (opis_cechy) VALUES ('Branza');

SET @id_br = LAST_INSERT_ID();


INSERT INTO CECHY (opis_cechy,jednowybieralna) VALUES ('Odpowiedz na Akcje Marketingowa - WIOSNA NASZA',1);

SET @id_am = LAST_INSERT_ID();


INSERT INTO WARTOSCI_CECH
(id_cechy
, opis_wartosci
) VALUES
(@id_br
, 'Komputery'
);

SET @id_br1 = LAST_INSERT_ID();

INSERT INTO FIRMY_CECHY (id_wartosci,id_firmy) VALUES (@id_br1,'HP');

INSERT INTO WARTOSCI_CECH
(	id_cechy
,	opis_wartosci
) VALUES
(	@id_br
,	'Drukarki'
);

SET @id_br1 = LAST_INSERT_ID();

INSERT INTO FIRMY_CECHY (id_firmy,id_wartosci) VALUES ('HP', @id_br1);


INSERT INTO WARTOSCI_CECH
(id_cechy
, opis_wartosci
) VALUES
(@id_br
, 'Szkolenia'
);

SET @id_br1 = LAST_INSERT_ID();

INSERT INTO FIRMY_CECHY (id_firmy,id_wartosci) VALUES ('HP', @id_br1);

INSERT INTO FIRMY_CECHY (id_firmy,id_wartosci) VALUES ('UKSW', @id_br1);


INSERT INTO WARTOSCI_CECH
(id_cechy
, opis_wartosci
) VALUES
(@id_am
, 'NIE'
);

INSERT INTO WARTOSCI_CECH
(id_cechy
, opis_wartosci
) VALUES
(@id_am
, 'TAK'
);

SET @id_br1 = LAST_INSERT_ID();

INSERT INTO FIRMY_CECHY (id_firmy,id_wartosci) VALUES ('HP', @id_br1);

INSERT INTO FIRMY_CECHY (id_firmy,id_wartosci) VALUES ('FLP', @id_br1);

```

---

## 1.  Wyœwietl zawartoœæ tabeli wojewodztwa.
``` {SQL}
SELECT * FROM wojewodztwa;
```

## 2.  Usuñ wojewodztwo opolskie.
``` {SQL}
DELETE FROM wojewodztwa WHERE wojewodztwo LIKE 'opolskie';
```

## 3.  Poka¿ wojewodztwo.
``` {SQL}
SELECT DISTINCT mazowieckie FROM wojewodztwa;
```

## 4.  Poka¿ wszystkie województwa na literê M (operator %).
``` {SQL}
SELECT wojewodztwo FROM wojewodztwa WHERE wojewodztwo like 'm%';
```

## 5.  Poka¿ wszystkie województwa zawieraj¹ce myœlnik w nazwie.
``` {SQL}
SELECT wojewodztwo FROM wojewodztwa WHERE wojewodztwo like '%-%';
```

## 6.  Poka¿ wszystkie województwa z nazw¹ koñcz¹ca siê na „ckie”.
``` {SQL}
SELECT wojewodztwo FROM wojewodztwa WHERE wojewodztwo like '%ckie';
```

## 7.  Poka¿ wszystkie województwa z nazw¹ na 7 liter.
``` {SQL}
SELECT `wojewodztwo` FROM wojewodztwa WHERE wojewodztwo like '_______';
```

## 8.  Dodaj na nowo wiersz z województwem opolskim.
``` {SQL}
INSERT INTO wojewodztwa (kod_w,wojewodztwo) VALUES ('','opolskie');
```

## 9.  Wyœwietl wszystkie wojewodztwa porz¹dkuj¹c je alfabetycznie.
``` {SQL}
SELECT wojewodztwo FROM wojewodztwa ORDER BY wojewodztwo ASC;
```

## 10. Wyœwietl zawartoœæ tabeli miasta.
``` {SQL}
SELECT * FROM miasta;
```

## 11. Do tabeli miast wprowadŸ jeszcze piêæ dowolnych (poprawnych) rekordów.
``` {SQL}
INSERT INTO miasta (kod_w, nazwa) VALUES ('pom', 'Gdynia');
INSERT INTO miasta (kod_w, nazwa) VALUES ('pom', 'Sopot');
INSERT INTO miasta (kod_w, nazwa) VALUES ('pom', 'Szczecin');
INSERT INTO miasta (kod_w, nazwa) VALUES ('maz', 'Marki');
INSERT INTO miasta (kod_w, nazwa) VALUES ('maz', 'Komorowo');
```

## 12. Ponownie wyœwietl zawartoœæ tabeli miasta alfabetycznie.
``` {SQL}
SELECT nazwa FROM miasta ORDER BY nazwa ASC;
```

## 13. Wyœwietl z jakich wojewodztw s¹ wszystkie miasta.
``` {SQL}
SELECT DISTINCT wojewodztwo FROM wojewodztwa WHERE kod_w IN (SELECT kod_w FROM miasta);
```

## 14. Wyœwietl z jakich wojewodztw s¹ wszystkie miasta, sortuj¹c je alfabetycznie wg nazw województw w porz¹dku rosn¹cym.
``` {SQL}
SELECT DISTINCT wojewodztwo FROM wojewodztwa WHERE kod_w IN (SELECT kod_w FROM miasta) ORDER BY wojewodztwo DESC;
```

## 15. Wyœwietl z jakich wojewodztw s¹ wszystkie miasta, sortuj¹c je alfabetycznie wg nazw  miast w porz¹dku malej¹cym.
``` {SQL}
SELECT nazwa, wojewodztwo FROM wojewodztwa, miasta WHERE wojewodztwa.kod_w = miasta.kod_w ORDER BY nazwa DESC;
```

## 16. Do tabeli osoby dodaj jeszcze jedn¹ kolumnê – imie2.
``` {SQL}

```

## 17. Zmieñ dane w tabeli osoby tak, aby id_o 3 i 5 zawiera³y dane: Jan W³odzimierz Szczêsny i Ewa Jadwiga Wyrwa.
``` {SQL}

```

## 18. Wyœwietl tylko te rekordy z tabeli osoby, które nie maj¹ pustego pola imie2.
``` {SQL}

```

## 19. Dodaj 5 nowych (poprawnych) rekordów do tabeli osoby.
``` {SQL}

```

## 20. Wyœwietl tylko te rekordy z tabeli osoby, które maj¹ id_o równe 3, 5 i 7.
``` {SQL}

```

## 21. Wyœwietl pe³ne dane personalne z tabeli osoby, ale tylko kobiet (koñcówka a).
``` {SQL}

```

## 22. Wyœwietl imiona i nazwiska osób, które w imieniu lub nazwisku maj¹ literê k.
``` {SQL}

```

## 23. Wyœwietl imiona i nazwiska osób, które w imieniu i nazwisku maj¹ literê a.
``` {SQL}

```

## 24. Z tabel osoby, miasta i wojewodztwa wyswietl ich ca³e zawartoœci.
``` {SQL}

```

## 25. Z tabel osoby, miasta i wojewodztwa wyœwietl wszystkie pola, które nie s¹ kluczami.
``` {SQL}

```

## 26. Wyœwietl imiona, nazwiska, daty zatrudnienia i stanowiska osób zatrudnionych pomiêdzy 1 stycznia 2000 roku a 31 grudnia 2001 roku.
``` {SQL}

```
